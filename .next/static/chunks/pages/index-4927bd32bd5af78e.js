(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3678)}])},3678:function(t,e,n){"use strict";n.r(e);var r=n(7568),o=n(655),c=n(5893),s=n(1163),i=n(7294),a=n(5564);e.default=function(){var t=(0,i.useState)(null),e=t[0],n=t[1],u=(0,i.useState)(null),l=u[0],f=u[1],d=(0,s.useRouter)();(0,i.useEffect)((function(){var t=sessionStorage.getItem("spotify_access_token");n(t);var e=function(){var e=(0,r.Z)((function(){var e,n,r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),[4,fetch("https://api.spotify.com/v1/me/top/tracks?limit=5",{headers:{Authorization:"Bearer ".concat(t)}})];case 1:return(e=o.sent()).ok?[4,e.json()]:[3,3];case 2:return n=o.sent(),f(n.items),[3,4];case 3:console.error("Failed to fetch top tracks:",e.statusText),o.label=4;case 4:return[3,6];case 5:return r=o.sent(),console.error("Error fetching top tracks:",r),[3,6];case 6:return[2]}}))}));return function(){return e.apply(this,arguments)}}();t&&e()}),[d.query]);return(0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{children:"Your top 5 tracks on Spotify"}),e?(0,c.jsxs)("div",{children:[l?(0,c.jsx)("ol",{children:l.map((function(t){return(0,c.jsxs)("li",{children:[t.name," by ",t.artists[0].name]},t.id)}))}):(0,c.jsx)("p",{children:"Loading your top tracks..."}),(0,c.jsx)("button",{onClick:function(){localStorage.removeItem("spotify_access_token"),n(null),f(null)},children:"Log out"})]}):(0,c.jsx)("button",{onClick:function(){return window.location.href=(0,a.d)()},children:"Log in with Spotify"})]})}},5564:function(t,e,n){"use strict";n.d(e,{d:function(){return l},h:function(){return f}});var r=n(7568),o=n(655),c=n(9669),s=n.n(c),i=n(7563),a="83cabe8ccb85435b9ad3c8cb2e83d111",u="http://localhost:3000/callback",l=function(){var t={client_id:a,response_type:"code",redirect_uri:u,show_dialog:!0,scope:"user-top-read"};return"https://accounts.spotify.com/authorize?".concat(i.stringify(t))},f=function(){var t=(0,r.Z)((function(t){var e,n,r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:e="https://accounts.spotify.com/api/token",n={client_id:a,client_secret:"b6bbd78d38404ce994dafb616a0d4aee",grant_type:"authorization_code",code:t,redirect_uri:u},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s().post(e,i.stringify(n),{headers:{"Content-Type":"application/x-www-form-urlencoded"}})];case 2:return[2,o.sent().data];case 3:throw r=o.sent(),console.error("Error during token exchange:",r),r;case 4:return[2]}}))}));return function(e){return t.apply(this,arguments)}}()}},function(t){t.O(0,[774,582,888,179],(function(){return e=5557,t(t.s=e);var e}));var e=t.O();_N_E=e}]);